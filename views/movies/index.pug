extends ../layout

block content
    .movies-header
        h1 My Movie Collection
        .header-actions
            .movies-stats
                if movies.length > 0
                    span.movie-count #{movies.length} movie#{movies.length !== 1 ? 's' : ''} in your collection
                else
                    span.movie-count No movies yet
            a.btn-primary(href="/movies/new") 
                span.btn-icon +
                span Add New Movie

    if movies.length > 0
        .movies-container
            .movies-grid
                each movie in movies
                    .movie-card
                        .movie-header
                            h3.movie-title
                                a(href=`/movies/${movie._id}`) #{movie.name}
                                if currentUser && movie.createdBy && movie.createdBy.toString() === currentUser._id.toString()
                                    span.owner-badge Your Movie
                            .movie-rating
                                .rating-stars
                                    - var stars = Math.round(movie.rating / 2)
                                    - var i = 0
                                    while i < 5
                                        if i < stars
                                            span.star.filled â˜…
                                        else
                                            span.star â˜†
                                        - i++
                                .rating-score #{movie.rating}/10
                        
                        .movie-meta
                            .movie-year
                                span.meta-label Year:
                                span.meta-value #{movie.year}
                            if movie.genres && movie.genres.length > 0
                                .movie-genres
                                    span.meta-label Genres:
                                    .genres-list
                                        each genre in movie.genres
                                            span.genre-tag #{genre}
                        
                        .movie-description
                            p= movie.description.substring(0, 120) + (movie.description.length > 120 ? '...' : '')
                        
                        .movie-actions
                            a.btn-secondary(href=`/movies/${movie._id}`) View Details
                            if currentUser && movie.createdBy && movie.createdBy.toString() === currentUser._id.toString()
                                a.btn-edit(href=`/movies/${movie._id}/edit`) Edit
                                form.delete-form(action=`/movies/${movie._id}?_method=DELETE` method="POST")
                                    button.btn-danger(type="submit" onclick="return confirm('Are you sure you want to delete this movie?')") Delete
    else
        .empty-state
            .empty-icon ðŸŽ¬
            h2 Start Your Movie Collection
            p You haven't added any movies yet. Create your first movie entry to begin building your personal movie database.
            a.btn-primary.btn-large(href="/movies/new") 
                span.btn-icon +
                span Add Your First Movie